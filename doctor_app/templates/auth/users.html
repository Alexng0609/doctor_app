{% extends 'base.html' %}
{% block content %}
<h1>User Management</h1>

<div style="margin-bottom: 20px;">
    <a href="{{ url_for('auth.register') }}" class="btn">Add New User</a>
</div>

<table style="width: 100%; border-collapse: collapse;">
    <thead>
        <tr style="background: #007bff; color: white;">
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Username</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Full Name</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Email</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Role</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Status</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Created</th>
            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr style="{% if not user.is_active %}opacity: 0.6;{% endif %}">
            <td style="padding: 10px; border: 1px solid #ddd;">
                <strong>{{ user.username }}</strong>
                {% if user.id == current_user.id %}<span style="color: #28a745; font-size: 12px;">(You)</span>{% endif %}
            </td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ user.full_name or '—' }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ user.email or '—' }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">
                <span style="padding: 4px 8px; border-radius: 3px; font-size: 12px; {% if user.role == 'admin' %}background: #ffc107; color: #000;{% else %}background: #007bff; color: white;{% endif %}">
                    {{ user.role|upper }}
                </span>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd;">
                <span style="padding: 4px 8px; border-radius: 3px; font-size: 12px; {% if user.is_active %}background: #28a745; color: white;{% else %}background: #dc3545; color: white;{% endif %}">
                    {{ 'Active' if user.is_active else 'Inactive' }}
                </span>
            </td>
            <td style="padding: 10px; border: 1px solid #ddd;">{{ user.created_at.strftime('%b %d, %Y') }}</td>
            <td style="padding: 10px; border: 1px solid #ddd;">
                <a href="{{ url_for('auth.edit_user', user_id=user.id) }}" class="btn" style="padding: 5px 10px; font-size: 13px; margin-right: 5px;">Edit</a>
                {% if user.id != current_user.id %}
                <form method="post" action="{{ url_for('auth.delete_user', user_id=user.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this user?');">
                    <button type="submit" class="btn" style="padding: 5px 10px; font-size: 13px; background: #dc3545;">Delete</button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="7" style="padding: 20px; text-align: center; border: 1px solid #ddd;">No users found</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div style="margin-top: 20px; padding: 15px; background: #e7f3ff; border-radius: 5px;">
    <strong>Total Users:</strong> {{ users|length }}
</div>
{% endblock %}